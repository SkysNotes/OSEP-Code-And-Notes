
Certainly! Below is a starting point for a cheat sheet that outlines various Active Directory (AD) attacks using tools like PowerShell, PowerUp, PowerView, BloodHound, and others. The table includes what to enumerate, how to exploit the information, and any special permissions required.

### Active Directory Attack Cheat Sheet

| **What to Enumerate**                          | **How to Exploit**                                                                                                                                                      | **Tools/Commands**                                                                                                                                       | **Special Permissions Required**                                                                                          |
|------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|
| **Domain Admins Group Members**                | Identify users in the Domain Admins group. Attempt to target these accounts through password spraying, phishing, or pass-the-hash attacks.                              | `Get-ADGroupMember "Domain Admins"` (PowerShell) <br> `Find-DomainAdmin` (PowerView)                                                                     | Read access to AD (generally available to authenticated users).                                                             |
| **Kerberoastable Accounts (SPNs)**             | Enumerate service accounts with SPNs, then request TGS tickets for these accounts to crack the hash offline (Kerberoasting).                                            | `Get-DomainUser -SPN` (PowerView) <br> `GetUserSPNs.py` (Impacket)                                                                                       | None (Any domain user can request TGS tickets).                                                                             |
| **Password Policy and Fine-Grained Policies**  | Enumerate password policies and fine-grained policies to find weak password requirements. Exploit by targeting accounts with weak passwords.                             | `Get-ADDefaultDomainPasswordPolicy` (PowerShell) <br> `Get-DomainPolicy` (PowerView)                                                                     | Read access to AD (generally available to authenticated users).                                                             |
| **Group Policy Objects (GPOs)**                | Enumerate GPOs to identify misconfigurations or writable GPOs. Exploit by modifying GPOs to execute malicious code on startup/logon.                                    | `Get-GPO` (PowerShell) <br> `Get-DomainGPO` (PowerView)                                                                                                  | Write permissions to GPOs, often requires administrative privileges.                                                        |
| **Users with AdminSDHolder**                   | Identify accounts protected by AdminSDHolder (e.g., Domain Admins). Exploit by targeting these accounts with phishing or password attacks.                               | `Get-AdminSDHolder` (PowerView) <br> `Get-DomainUser -AdminCount 1` (PowerView)                                                                          | Read access to AD (generally available to authenticated users).                                                             |
| **Writables on AD Objects (ACLs)**             | Enumerate writable ACLs on AD objects to find users or groups that can be modified. Exploit by adding privileges or changing group memberships.                          | `Get-ObjectAcl` (PowerView) <br> `Get-ACL` (PowerShell)                                                                                                  | Requires write permissions on the targeted AD objects.                                                                     |
| **AD Trust Relationships**                     | Enumerate trust relationships between domains or forests. Exploit by moving laterally or escalating privileges across trusted domains/forests.                          | `Get-DomainTrust` (PowerView) <br> `Get-NetDomainTrust` (PowerSploit) <br> BloodHound                                                                    | Read access to AD (generally available to authenticated users).                                                             |
| **SID History Abuse**                          | Enumerate SID History to identify accounts with privileged SIDs. Exploit by injecting SIDs from SID History to escalate privileges.                                     | `Get-DomainUser` (PowerView) <br> `Get-ADUser` (PowerShell)                                                                                              | Requires write permissions on the targeted AD objects and knowledge of the SID to inject.                                   |
| **Privileged Group Memberships**               | Enumerate memberships of privileged groups (e.g., Domain Admins, Enterprise Admins). Exploit by targeting these accounts for password attacks or pass-the-ticket attacks. | `Get-ADGroupMember` (PowerShell) <br> `Find-PrivilegedGroupMembers` (PowerView)                                                                          | Read access to AD (generally available to authenticated users).                                                             |
| **Domain Controller Enumeration**              | Enumerate Domain Controllers (DCs) to target for DC synchronization attacks, DCSync, or NTDS.dit extraction.                                                             | `Get-ADDomainController` (PowerShell) <br> `Get-NetDomainController` (PowerSploit) <br> `Find-DomainController` (BloodHound)                             | Read access to AD (generally available to authenticated users).                                                             |
| **DNS Admin Group Memberships**                | Identify members of the DNS Admins group, which can be abused to escalate privileges or perform DNS poisoning attacks.                                                  | `Get-ADGroupMember "DNS Admins"` (PowerShell) <br> `Find-DomainGroupMember -Identity "DNS Admins"` (PowerView)                                           | Read access to AD (generally available to authenticated users).                                                             |
| **Unconstrained Delegation Accounts**          | Identify accounts and computers configured for unconstrained delegation, which can be abused to steal TGTs and escalate privileges.                                     | `Get-DomainUser -Unconstrained` (PowerView) <br> `Get-DomainComputer -Unconstrained` (PowerView)                                                         | Read access to AD (generally available to authenticated users).                                                             |
| **Constrained Delegation and RBCD Accounts**   | Enumerate accounts configured for constrained or resource-based constrained delegation. Exploit by impersonating users and accessing services.                          | `Get-DomainUser -TrustedToAuth` (PowerView) <br> `Get-DomainObjectAcl` (PowerView) <br> `Get-DomainComputer -AllowedToAct` (PowerView)                   | Requires control of an account or computer configured for constrained delegation or RBCD.                                   |
| **Password Spraying Attack Targets**           | Enumerate user accounts to identify potential targets for password spraying attacks.                                                                                   | `Get-DomainUser` (PowerView) <br> `Get-ADUser -Filter *` (PowerShell)                                                                                   | None (Any domain user can enumerate other users).                                                                           |
| **Shadow Admins**                              | Identify shadow admins who have permissions equivalent to domain admins but are not directly in the Domain Admins group.                                                | `Find-UserField -UserProperties "AdminCount"` (PowerView) <br> BloodHound                                                                               | Read access to AD (generally available to authenticated users).                                                             |
| **LAPS Passwords**                             | Enumerate LAPS (Local Administrator Password Solution) passwords if access is granted to the AD attribute storing these passwords.                                      | `Find-InterestingDomainAcl` (PowerView) <br> `Get-ADComputer -Filter * -Property ms-Mcs-AdmPwd` (PowerShell)                                            | Requires access to the `ms-Mcs-AdmPwd` attribute in AD (generally restricted to specific groups or users).                  |
| **SID Filtering on Trusts**                    | Check if SID Filtering is disabled on trust relationships, which can be abused to escalate privileges across trusted domains.                                           | `Get-DomainTrust -SIDFiltering` (PowerView)                                                                                                            | Read access to AD and trust relationships.                                                                                  |
| **AD Recycle Bin**                             | Identify if the AD Recycle Bin is enabled, which might allow attackers to restore deleted privileged objects.                                                           | `Get-ADOptionalFeature -Filter {name -like 'Recycle Bin'}` (PowerShell)                                                                                 | Requires permissions to modify or restore objects in the AD Recycle Bin.                                                    |
| **GPP Passwords**                              | Enumerate Group Policy Preferences (GPP) to find stored credentials that can be decrypted and used for privilege escalation.                                            | `Get-GPPPassword` (PowerSploit) <br> `Get-ADGPOReport -All -ReportType XML` (PowerShell)                                                                 | Read access to GPOs (any authenticated domain user typically has access).                                                    |
| **SPNs for SQL Servers**                       | Identify SPNs for SQL Servers to target for SQL Service account credential extraction or lateral movement.                                                              | `Get-DomainUser -SPN "MSSQLSvc*"` (PowerView) <br> `GetUserSPNs.py` (Impacket)                                                                          | None (Any domain user can request TGS tickets).                                                                             |
| **DCShadow Attack**                            | Enumerate writable DCs and exploit by registering a rogue DC to push malicious changes to AD, such as adding users to privileged groups.                                | `Get-ADDomainController -Writable` (PowerShell) <br> `Get-DCShadowTarget` (PowerView)                                                                   | Requires Domain Admin or Enterprise Admin privileges to register a rogue DC.                                                |

### Key Points:
- **Enumeration**: The first step in any attack is identifying the target environment, which involves listing users, groups, ACLs, SPNs, GPOs, and other AD objects. Tools like PowerView, BloodHound, and native PowerShell cmdlets are highly effective for this purpose.
- **Exploitation**: After enumeration, specific attack vectors can be exploited, such as Kerberoasting, Pass-the-Hash, or abuse of delegation rights. Tools like PowerUp, PowerSploit, and Impacket are crucial for executing these attacks.
- **Permissions**: The success of an attack often depends on the permissions available to the attacker. Some attacks require no special privileges, while others, such as modifying GPOs or performing DCShadow attacks, require high-level privileges like Domain Admin.

### Expanding the Table:
- **Add More Advanced Attacks**: Over time, you can add more advanced attack techniques such as AS-REP Roasting, abusing cross-domain trusts, and techniques like Golden Ticket and Silver Ticket attacks.
